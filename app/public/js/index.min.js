let api_key="98c9a344a165964484231faf23acdf5c";const openNavBtn=document.getElementById("openNavBtn"),closeNavBtn=document.getElementById("closeNavBtn"),nav=document.querySelector(".header__nav");openNavBtn.addEventListener("click",()=>{nav.style.transform="translateX(0)"}),closeNavBtn.addEventListener("click",()=>{nav.style.transform="translateX(-200%)"});const date=new Date;let day=date.toLocaleString("en-US",{weekday:"short"}),dayOfMonth=date.getDate(),month=date.toLocaleString("en-us",{month:"short"});const currentDate=document.getElementById("currentDate");currentDate.innerText=`${day}, ${dayOfMonth} ${month}`;const getWeatherData=async e=>{var{latitude:t,longitude:e}=e.coords;try{var a=await axios.get(`https://api.openweathermap.org/data/2.5/onecall?lat=${t}&lon=${e}&units=metric&exclude=minutely,hourly,alerts&appid=${api_key}`),n=await axios.get(`https://api.openweathermap.org/data/2.5/weather?lat=${t}&lon=${e}&appid=${api_key}`),r=a.data.current,o=a.data.daily;setHighlightsValues(r);const c=document.querySelector(".main__content--cards");c.innerHTML="";for(let e=0;e<5;e++)createCards(o,e);const i=document.getElementById("currentLocation");i.innerText=n.data.name}catch(e){console.error(e)}},createCards=(e,t)=>{const a=new Date(date);a.setDate(a.getDate()+t+1);var n=a.toString().split(" ").slice(0,3),r=iconFilter(e[t].weather[0].icon),t=`<div class="main__content--cards-card">
  <h5 class="card__title">${n[0]}, ${n[2]} ${n[1]}</h5>
  <img
    src=${r}
    alt="shower"
    class="card__image"
  />
  <div class="card__temps">
    <p class="card__temps--day">${Math.round(e[t].temp.day)}</p>
    <p class="card__temps--night">${Math.round(e[t].temp.night)}</p>
  </div>
</div>
`;const o=document.querySelector(".main__content--cards");o.insertAdjacentHTML("beforeend",t)},setHighlightsValues=e=>{var t=iconFilter(e.weather[0].icon);const a=document.getElementById("asideTemperature");a.innerText=Math.round(e.temp);const n=document.getElementById("asideImage");n.setAttribute("src",`${t}`);const r=document.getElementById("asideWeatherType");r.innerText=e.weather[0].main;const o=document.querySelector(".panel__wind--value");o.innerText=e.wind_speed.toFixed(1);const c=document.querySelector(".panel__wind--direction-direction");c.innerText=degToDirection(e.wind_deg);const i=document.querySelector(".panel__humidity--value");i.innerText=e.humidity;const s=document.querySelector(".panel__humidity--progress-bar");s.setAttribute("value",.01*e.humidity),s.setAttribute("title",`${e.humidity}%`);const d=document.querySelector(".panel__visibility--value");d.innerText=`${(e.visibility/1e3).toFixed(1)}km`;const l=document.querySelector(".panel__pressure--value");l.innerText=`${e.pressure}hPa`},degToDirection=e=>{return["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"][Math.round(e)%16]},iconFilter=e=>{var t="./app/public/images/";const a=`${t}Clear.svg`,n=`${t}BrokenClouds.svg`,r=`${t}HeavyCloud.svg`,o=`${t}HeavyRain.svg`,c=`${t}LightCloud.svg`,i=`${t}Mist.svg`,s=`${t}Shower.svg`,d=`${t}Snow.svg`,l=`${t}Thunderstorm.svg`;switch(e){case"01d":case"01n":return a;case"02d":case"02n":return c;case"03d":case"03n":return r;case"04d":case"04n":return n;case"09d":case"09n":return o;case"10d":case"10n":return s;case"11d":case"11n":return l;case"13d":case"13n":return d;case"50d":case"50n":return i;default:return a}},searchBtn=document.getElementById("searchBtn"),searchBar=document.getElementById("searchBar"),recentCities=document.getElementById("recentCities");searchBtn.addEventListener("click",()=>{var e;""!=searchBar.value||"string"!=typeof searchBar.value?(e=searchBar.value[0].toUpperCase()+searchBar.value.substring(1),localStorage.setItem("SearchList",JSON.stringify([e])),searchByCity(searchBar.value),nav.style.transform="translateX(-200%)"):alert("Please enter correct city name")});const searchByCity=e=>{axios.get(`https://api.openweathermap.org/data/2.5/weather?q=${e}&appid=${api_key}`).then(({data:e})=>{var{lat:t,lon:a}=e.coord;const n=document.getElementById("currentLocation");n.innerText=e.name,axios.get(`https://api.openweathermap.org/data/2.5/onecall?lat=${t}&lon=${a}&units=metric&exclude=minutely,hourly,alerts&appid=${api_key}`).then(({data:t})=>{setHighlightsValues(t.current);const e=document.querySelector(".main__content--cards");e.innerHTML="";for(let e=0;e<5;e++)createCards(t.daily,e)})})};let newArr=JSON.parse(localStorage.getItem("SearchList"));newArr&&newArr.map(e=>{recentCities.innerHTML+=`<button class="header__nav--recent-cities-city">${e}</button>`;const t=document.querySelectorAll(".header__nav--recent-cities-city");t.forEach(e=>e.addEventListener("click",()=>{searchByCity(e.innerText),nav.style.transform="translateX(-200%)"}))});const userLocationError=()=>{window.confirm(`Turn on your localisation or search weather by city\n
  If you don't know how to turn it back on click 'Ok'`)&&window.open("https://support.google.com/chrome/answer/114662?hl=en&co=GENIE.Platform%3DDesktop","_blank");getWeatherData({coords:{latitude:52.237049,longitude:21.017532}})},options={enableHighAccuracy:!0},locationBtn=document.getElementById("locationBtn");locationBtn.addEventListener("click",()=>{window.navigator.geolocation&&window.navigator.geolocation.getCurrentPosition(getWeatherData,userLocationError,options)}),window.navigator.geolocation&&window.navigator.geolocation.getCurrentPosition(getWeatherData,userLocationError,options);